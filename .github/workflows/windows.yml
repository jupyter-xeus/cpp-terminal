name: Windows CI

on: [push, pull_request]

jobs:
  Build:
    runs-on: windows-latest
    strategy:
      fail-fast: false

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Build
      run: |
          ci\compile_test.ps1
    - name: Test
      run: ci\test.ps1

    - name: Standalone
      run: cmake -DCMAKE_INSTALL_PREFIX=./standalone-install -DCMAKE_PREFIX_PATH=${{ github.workspace }}/install/ -S ./tests/test-standalone -B ./standalone-build; cmake --build ./standalone-build ; cmake --install ./standalone-build
